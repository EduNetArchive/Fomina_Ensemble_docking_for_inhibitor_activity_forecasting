В этой папке представлен код для машинного обучения и визуализации данных, а так же заранее подготовленные файлы с датасетами. Код для подготовки датасетов требует специализированных библиотек RDKit и ODDT, которые не всегда работают в Google Collaboratory, и очень большого объема начальных данных - результатов докинга, поэтому здесь он не представлен, но может быть продемонстрирован по запросу.

Код:

1. Chembl4495582\_main.ipynb - основной ноутбук с подбором параметров машинного обучения
2. CHEMBL4495582\_Bar\_Charts.ipynb - ноутбук с графиками, построенными по рассчитанным в "Chembl4495582\_main" метрикам. Совпадает с разделом Best models - statistics for traint-test split в ноутбукеChembl4495582\_main.ipynb
3. CHEMBL4495582\_SHAP\_analysis.ipynb - Анализ вкладов признаков для лучших моделей при помощи SHAP
4. Chembl4495582\_vote\_on\_batches.ipynb - Код для подготовки данных и обучения ансамблевой модели. Также требует библиотеки RDKit, но часть кода, посвященную обучению моделей, можно выполнить, считав батчи из файла 'batches\_ensemble\_learning.txt'

Датасеты:

Chembl4495582\_with\_gridscores.scv - файл с исходной библиотекой соединений, содержащий поля:

| № | Название поля | Тип данных | Содержание |
| --- | --- | --- | --- |
| 1 | Index | integer | Идентификационный номер соединения |
| 2 | Chembl\_Name | string | Код соединения в базе данных Chembl |
| 3 | Grid\_Score\_7jkv | float | Оценка докинга соединения в структуру 7jkv |
| 4 | Grid\_Score\_7cb7 | float | Оценка докинга соединения в структуру 7cb7 |
| 5 | Grid\_Score\_7mpb | float | Оценка докинга соединения в структуру 7mpb |
| 6 | Grid\_Score\_7mhp | float | Оценка докинга соединения в структуру 7mhp |
| 7 | Grid\_Score\_7vh8 | float | Оценка докинга соединения в структуру 7vh8 |
| 8 | Grid\_Score\_7rc0 | float | Оценка докинга соединения в структуру 7rc0 |
| 9 | N | integer | Номер соединения в базе данных до фильтрации |
| 10 | Smiles | string | Структура соединения в формате SMILES |
| 11 | Mw | float | Молекулярная масса |
| 12 | Formula | string | Эмпирическая формула |
| 13 | Name | string | Название соединения |
| 14 | Max\_phase | integer | Фаза клинических испытаний, в которой находится соединение |
| 15 | AlogP | float | Логарифм коэффициента распределения вода-октанол |
| 16 | Alias | string | Альтернативное название соединения |
| 17 | Percent | float | Процент ингибирования Mpro SARS-CoV-2 |
| 18 | Experiment\_label | boolean | Маркер активности |
| 19 | positive\_gridscore\_7jkv | float | Модуль оценки докинга соединения в структуру 7jkv |
| 20 | positive\_gridscore\_7cb7 | float | Модуль оценки докинга соединения в структуру 7cb7 |
| 21 | positive\_gridscore\_7mpb | float | Модуль оценки докинга соединения в структуру 7mpb |
| 22 | positive\_gridscore\_7mhp | float | Модуль оценки докинга соединения в структуру 7mhp |
| 23 | positive\_gridscore\_7vh8 | float | Модуль оценки докинга соединения в структуру 7vh8 |
| 24 | positive\_gridscore\_7rc0 | float | Модуль оценки докинга соединения в структуру 7rc0 |
| 25 | Minscore | float | Минимальная оценка докинга |
| 26 | positive\_Minscore | float | Модуль минимальной оценки докинга |

Обучающие выборки:

| № | Название | Состав | Длины составляющих векторов | Общая длина вектора |
| --- | --- | --- | --- | --- |
| 1 | OHF | One-hot закодированные фингерпринты взаимодействия Flare-IFP, Dock6.9 Grid Scores, Mw, CLogP | 7971,6,1,1 | 7979 |
| --- | --- | --- | --- | --- |
| 2 | FL | Явно заданные фингерпринты взаимодействия Flare-IFP, Dock6.9 Grid Scores, Mw, CLogP | 377, 6,1,1 | 385 |
| 3 | FLE | Явно заданные фингерпринты взаимодействия Flare-IFP, лигандные эффективности, Mw, CLogP | 377, 6,1,1 | 385 |
| 4 | M5F | Фингерпринты Моргана (512б, радиус 3), явно заданные фингерпринты взаимодействия Flare-IFP, Dock6.9 Grid Scores, Mw, CLogP | 512,377,6,1,1 | 897 |
| 5 | M5 | Фингерпринты Моргана (512б, радиус 3), Dock6.9 Grid Scores, Mw, CLogP | 512,6,1,1 | 520 |
| 6 | M5O | Фингерпринты Моргана (512б, радиус 3), фингерпринты взаимодействия ODDT-IFP, Dock6.9 Grid Scores, Mw, CLogP | 512,497,6,1,1 | 1017 |
| 7 | OIF | Фингерпринты взаимодействия ODDT-IFP, Dock6.9 Grid Scores, Mw, CLogP | 497,6,1,1 | 505 |
| 8 | M1 | Фингерпринты Моргана (1024б, радиус 3), Dock6.9 Grid Scores, Mw, CLogP | 1024,6,1,1 | 1032 |
| 9 | M1O | Фингерпринты Моргана (1024б, радиус 3), фингерпринты взаимодействия ODDT-IFP, Dock6.9 Grid Scores, Mw, CLogP | 1024,497,6,1,1 | 1529 |

Вы можете скачать данные [по ссылке](https://edunet.kea.su/students_datasets/Biology_and_Chemistry/Fomina-Ensemble_docking.zip).